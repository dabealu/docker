### KVM virtual machine in docker container

Container must be started in privileged mode and with host network, it creates dedicated network interface (tapX) on hosts linux bridge (bridge must be preconfigured on host) with mac addr dynamically generated by qemu-mac-hasher.py (this MAC persistent untill VM name changed).  
VM HDD image will be created automatically by run_vm.sh script in /virt_machines directory, if theres no image named ${VM_NAME}.qcow, if it already aexists it will be used by VM.  

Simplest way to use this image is to copy kvm dir for new vm, fill docker-compose.yml with env variables values which define VM parameters, and start VM container with 'docker-compose up -d'.  
If you want to install OS from CD, connect to it with spice client (for example spicy - spice-client-gtk) and press F12 for boot menu.  
Persistent data such as VM HDD images and ISO images reside in /virt_machines directory so this directory is mounted from host.  

VM configuration variables:  
- VM_NAME - name of virtual machine  
- VM_HDSIZE - virtual HDD size (GB)  
- VM_MEMORY - VM memory (MB)  
- VM_CORES - VM CPU cores  
- SPICE_PORT - spice console port number  
- SPICE_PASSWD - spice console password  
- VM_CDROM - path to ISO image inside container (usually /virt_machines/ISO/cdrom.iso or ISO/cdrom.iso)  
all variables are REQUIRED except VM_CDROM (and VM_HDSIZE will be ignored if image already exist).  

To permanently poweroff VM inside container you need to change restart policy (with 'restart: always' container will be restarted and bring back VM each time VM poweroffs) or stop container instead of VM.  
